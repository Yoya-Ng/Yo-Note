---

// src/components/user/ProgressTracker.astro
---
interface Course {
  id: number;
  name: string;
  progress: number;
  completed: number;
  total: number;
}

interface Activity {
  id: number;
  icon: string;
  title: string;
  date: string;
}

interface Props {
  isLoggedIn?: boolean;
  hasPremium?: boolean;
}

const { 
  isLoggedIn = false, 
  hasPremium = false,
} = Astro.props;

const courses: Course[] = [
  { id: 1, name: 'Java åŸºç¤', progress: 85, completed: 17, total: 20 },
  { id: 2, name: 'Spring Boot é€²éš', progress: 60, completed: 9, total: 15 },
  { id: 3, name: 'React å¯¦æˆ°', progress: 40, completed: 6, total: 15 },
];

const recentActivities: Activity[] = [
  { id: 1, icon: 'âœ…', title: 'å®Œæˆèª²ç¨‹: Spring Boot åŸºç¤', date: 'ä»Šå¤© 14:30' },
  { id: 2, icon: 'ğŸ¯', title: 'é”æˆ 7 å¤©é€£çºŒç°½åˆ°', date: 'æ˜¨å¤© 09:00' },
  { id: 3, icon: 'ğŸ“', title: 'å®Œæˆæ¸¬é©—: Java é€²éšèªæ³•', date: '3 å¤©å‰' },
  { id: 4, icon: 'ğŸ†', title: 'ç²å¾—æˆå°±: å¿«é€Ÿå­¸ç¿’è€…', date: 'ä¸€é€±å‰' },
];
---

<div class="tracker-container section container">
  {!isLoggedIn && (
    <div class="access-denied glass rounded-lg p-8 text-center">
      <h2 class="text-2xl font-bold mb-4">ğŸ“Š é€²åº¦è¿½è¹¤</h2>
      <p class="mb-6">æ­¤åŠŸèƒ½åƒ…é™å·²ç™»å…¥ç”¨æˆ¶ä½¿ç”¨</p>
      <a href="/login" class="btn btn-primary">å‰å¾€ç™»å…¥</a>
    </div>
  )}

  {isLoggedIn && !hasPremium && (
    <div class="premium-required glass rounded-lg p-8 text-center">
      <h2 class="text-2xl font-bold mb-4">ğŸ”’ é«˜ç´šåŠŸèƒ½</h2>
      <p class="mb-6">é€²åº¦è¿½è¹¤åŠŸèƒ½éœ€è¦é«˜ç´šæœƒå“¡æ¬Šé™</p>
      
      <div class="features bg-bg-t p-4 rounded my-6 text-left">
        <h3 class="font-bold mb-3">é«˜ç´šæœƒå“¡å¯äº«å—ï¼š</h3>
        <ul class="list-none space-y-2">
          <li>âœ“ è©³ç´°çš„å­¸ç¿’é€²åº¦åˆ†æ</li>
          <li>âœ“ å®Œæˆåº¦çµ±è¨ˆåœ–è¡¨</li>
          <li>âœ“ å€‹äººåŒ–å»ºè­°</li>
          <li>âœ“ å°å‡ºé€²åº¦å ±å‘Š</li>
        </ul>
      </div>
      
      <button onclick="upgradeToPremium()" class="btn btn-upgrade">å‡ç´šåˆ°é«˜ç´šæœƒå“¡</button>
    </div>
  )}

  {isLoggedIn && hasPremium && (
    <div class="tracker-content">
      <h2 class="text-2xl font-bold mb-6">ğŸ“Š é€²åº¦è¿½è¹¤</h2>
      
      <div class="stats-grid grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="stat-box glass rounded-lg p-4">
          <h3 class="font-semibold mb-3">ç¸½å®Œæˆåº¦</h3>
          <div class="progress-bar w-full h-2 bg-gray-300 rounded-full overflow-hidden mb-2">
            <div class="progress h-full bg-gradient-to-r from-blue-500 to-purple-500" style="width: 65%"></div>
          </div>
          <p class="text-lg font-bold">65%</p>
        </div>

        <div class="stat-box glass rounded-lg p-4">
          <h3 class="font-semibold mb-2">æœ¬æœˆå­¸ç¿’æ™‚æ•¸</h3>
          <p class="text-3xl font-bold">28h</p>
          <p class="text-sm text-gray-500">ç›®æ¨™: 40h</p>
        </div>

        <div class="stat-box glass rounded-lg p-4">
          <h3 class="font-semibold mb-2">é€£çºŒç°½åˆ°å¤©æ•¸</h3>
          <p class="text-3xl font-bold">12</p>
          <p class="text-sm text-gray-500">ğŸ”¥ ä¿æŒåŠ æ²¹!</p>
        </div>
      </div>

      {/* èª²ç¨‹é€²åº¦ */}
      <section class="courses-section glass rounded-lg p-6 mb-6">
        <h3 class="text-xl font-bold mb-4">èª²ç¨‹é€²åº¦</h3>
        <div class="space-y-4">
          {courses.map((course) => (
            <div class="course-item">
              <div class="flex justify-between mb-2">
                <span class="font-semibold">{course.name}</span>
                <span class="text-sm">{course.progress}%</span>
              </div>
              <div class="progress-bar w-full h-2 bg-gray-300 rounded-full overflow-hidden mb-1">
                <div 
                  class="progress h-full bg-gradient-to-r from-blue-500 to-purple-500" 
                  style={`width: ${course.progress}%`}
                ></div>
              </div>
              <p class="text-xs text-gray-500">{course.completed} / {course.total} å®Œæˆ</p>
            </div>
          ))}
        </div>
      </section>

      {/* æœ€è¿‘æ´»å‹• */}
      <section class="activity-section glass rounded-lg p-6">
        <h3 class="text-xl font-bold mb-4">æœ€è¿‘æ´»å‹•</h3>
        <div class="space-y-3">
          {recentActivities.map((activity) => (
            <div class="activity-item flex items-start gap-3 p-3 rounded bg-gray-50 dark:bg-gray-800">
              <span class="icon text-xl">{activity.icon}</span>
              <div>
                <p class="font-semibold">{activity.title}</p>
                <p class="text-sm text-gray-500">{activity.date}</p>
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>
  )}
</div>

<script>
const upgradeToPremium = () => {
  alert('å‡ç´šåŠŸèƒ½å°šæœªå¯¦ç¾ï¼Œè«‹è¯çµ¡ç®¡ç†å“¡');
};
</script>

<style>
.tracker-container {
  @apply section container;
}

.access-denied, .premium-required {
  @apply glass rounded-lg p-8 text-center;
}

.stats-grid {
  @apply grid grid-cols-1 md:grid-cols-3 gap-4;
}

.stat-box {
  @apply shadow;
}

.progress-bar {
  @apply w-full h-2 bg-gray-300 rounded-full overflow-hidden;
}

.progress {
  @apply h-full transition-all;
}

.course-item {
  @apply p-3 border rounded-lg border-gray-200 dark:border-gray-700;
}

.activity-item {
  @apply flex items-start gap-3 p-3 rounded bg-gray-50 dark:bg-gray-800;
}

.btn {
  @apply px-4 py-2 rounded-lg font-semibold transition-colors;
}

.btn-primary {
  @apply bg-blue-500 text-white hover:bg-blue-600;
}

.btn-upgrade {
  @apply bg-yellow-500 text-white hover:bg-yellow-600;
}
</style>
